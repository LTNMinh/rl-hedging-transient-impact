cuda
Populate Replay Buffer... 
0.996031746031746 1
0.9920634920634921 2
0.9880952380952381 3
0.9841269841269842 4
0.9801587301587302 5
0.9761904761904763 6
0.9722222222222223 7
0.9682539682539684 8
0.9642857142857144 9
0.9603174603174605 10
0.9563492063492065 11
0.9523809523809526 12
0.9484126984126986 13
0.9444444444444446 14
0.9404761904761907 15
0.9365079365079367 16
0.9325396825396828 17
0.9285714285714288 18
0.9246031746031749 19
0.9206349206349209 20
0.916666666666667 21
0.912698412698413 22
0.908730158730159 23
0.9047619047619051 24
0.9007936507936511 25
0.8968253968253972 26
0.8928571428571432 27
0.8888888888888893 28
0.8849206349206353 29
0.8809523809523814 30
0.8769841269841274 31
0.8730158730158735 32
0.8690476190476195 33
0.8650793650793656 34
0.8611111111111116 35
0.8571428571428577 36
0.8531746031746037 37
0.8492063492063497 38
0.8452380952380958 39
0.8412698412698418 40
0.8373015873015879 41
0.8333333333333339 42
0.82936507936508 43
0.825396825396826 44
0.8214285714285721 45
0.8174603174603181 46
0.8134920634920642 47
0.8095238095238102 48
0.8055555555555562 49
0.8015873015873023 50
0.7976190476190483 51
0.7936507936507944 52
0.7896825396825404 53
0.7857142857142865 54
0.7817460317460325 55
0.7777777777777786 56
0.7738095238095246 57
0.7698412698412707 58
0.7658730158730167 59
0.7619047619047628 60
0.7579365079365088 61
0.7539682539682548 62
0.7500000000000009 63
0.7460317460317469 64
0.742063492063493 65
0.738095238095239 66
0.7341269841269851 67
0.7301587301587311 68
0.7261904761904772 69
0.7222222222222232 70
0.7182539682539693 71
0.7142857142857153 72
0.7103174603174613 73
0.7063492063492074 74
0.7023809523809534 75
0.6984126984126995 76
0.6944444444444455 77
0.6904761904761916 78
0.6865079365079376 79
0.6825396825396837 80
0.6785714285714297 81
0.6746031746031758 82
0.6706349206349218 83
0.6666666666666679 84
0.6626984126984139 85
0.6587301587301599 86
0.654761904761906 87
0.650793650793652 88
0.6468253968253981 89
0.6428571428571441 90
0.6388888888888902 91
0.6349206349206362 92
0.6309523809523823 93
0.6269841269841283 94
0.6230158730158744 95
0.6190476190476204 96
0.6150793650793664 97
0.6111111111111125 98
0.6071428571428585 99
0.6031746031746046 100
0.5992063492063506 101
0.5952380952380967 102
0.5912698412698427 103
0.5873015873015888 104
0.5833333333333348 105
0.5793650793650809 106
0.5753968253968269 107
0.571428571428573 108
0.567460317460319 109
0.563492063492065 110
0.5595238095238111 111
0.5555555555555571 112
0.5515873015873032 113
0.5476190476190492 114
0.5436507936507953 115
0.5396825396825413 116
0.5357142857142874 117
0.5317460317460334 118
0.5277777777777795 119
0.5238095238095255 120
0.5198412698412715 121
0.5158730158730176 122
0.5119047619047636 123
0.5079365079365097 124
0.5039682539682557 125
0.5000000000000018 126
0.4960317460317478 127
0.49206349206349387 128
0.4880952380952399 129
0.48412698412698596 130
0.480158730158732 131
0.47619047619047805 132
0.4722222222222241 133
0.46825396825397014 134
0.4642857142857162 135
0.46031746031746223 136
0.4563492063492083 137
0.4523809523809543 138
0.4484126984127004 139
0.4444444444444464 140
0.44047619047619246 141
0.4365079365079385 142
0.43253968253968456 143
0.4285714285714306 144
0.42460317460317665 145
0.4206349206349227 146
0.41666666666666874 147
0.4126984126984148 148
0.40873015873016083 149
0.4047619047619069 150
0.4007936507936529 151
0.39682539682539897 152
0.392857142857145 153
0.38888888888889106 154
0.3849206349206371 155
0.38095238095238315 156
0.3769841269841292 157
0.37301587301587524 158
0.3690476190476213 159
0.36507936507936734 160
0.3611111111111134 161
0.3571428571428594 162
0.3531746031746055 163
0.3492063492063515 164
0.34523809523809756 165
0.3412698412698436 166
0.33730158730158966 167
0.3333333333333357 168
0.32936507936508175 169
0.3253968253968278 170
0.32142857142857384 171
0.3174603174603199 172
0.31349206349206593 173
0.309523809523812 174
0.305555555555558 175
0.30158730158730407 176
0.2976190476190501 177
0.29365079365079616 178
0.2896825396825422 179
0.28571428571428825 180
0.2817460317460343 181
0.27777777777778034 182
0.2738095238095264 183
0.26984126984127244 184
0.2658730158730185 185
0.2619047619047645 186
0.2579365079365106 187
0.2539682539682566 188
0.25000000000000266 189
0.2460317460317487 190
0.24206349206349476 191
0.2380952380952408 192
0.23412698412698685 193
0.2301587301587329 194
0.22619047619047894 195
0.22222222222222499 196
0.21825396825397103 197
0.21428571428571708 198
0.21031746031746312 199
0.20634920634920917 200
0.20238095238095521 201
0.19841269841270126 202
0.1944444444444473 203
0.19047619047619335 204
0.1865079365079394 205
0.18253968253968544 206
0.1785714285714315 207
0.17460317460317754 208
0.17063492063492358 209
0.16666666666666963 210
0.16269841269841567 211
0.15873015873016172 212
0.15476190476190776 213
0.1507936507936538 214
0.14682539682539986 215
0.1428571428571459 216
0.13888888888889195 217
0.134920634920638 218
0.13095238095238404 219
0.12698412698413009 220
0.12301587301587612 221
0.11904761904762215 222
0.11507936507936818 223
0.11111111111111421 224
0.10714285714286025 225
0.10317460317460628 226
0.09920634920635231 227
0.09523809523809834 228
0.09126984126984437 229
0.0873015873015904 230
0.08333333333333644 231
0.07936507936508247 232
0.0753968253968285 233
0.07142857142857453 234
0.06746031746032057 235
0.0634920634920666 236
0.05952380952381263 237
0.05555555555555866 238
0.05158730158730469 239
0.047619047619050725 240
0.04365079365079676 241
0.03968253968254279 242
0.03571428571428882 243
0.03174603174603485 244
0.027777777777780885 245
0.023809523809526917 246
0.01984126984127295 247
0.01587301587301898 248
0.011904761904765013 249
0.007936507936511045 250
0.003968253968257077 251
3.1086244689504383e-15 252
Traceback (most recent call last):
  File "main.py", line 48, in <module>
    name_cases='Option Hedging'
  File "/content/rl-hedging-transient-impact/agent.py", line 171, in __init__
    self.populate(self.initial_random_episode)
  File "/content/rl-hedging-transient-impact/agent.py", line 198, in populate
    next_state, reward, done, _ = self.env.step(selected_action)
  File "/content/rl-hedging-transient-impact/hedging_environment.py", line 108, in step
    self.portfolio_value[self.time_step] = adjust_holding * current_price
IndexError: index 252 is out of bounds for axis 0 with size 252
